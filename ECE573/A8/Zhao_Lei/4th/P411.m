A = [1 -0.5; 0 0.5];
b = [1; -1];
c = [0.5; 0.5];
d = -1;
de = 0.01;
e = 0.00000001;
global ta;
ta = 1;

%disp(X);
x1 = 2;
x2 = 2;
X = [x1; x2];

x1 = X(1);
x2 = X(2);


g1 = (2*x1 - x2 + 2)/(x1/2 + x2/2 - 1) - ((x1 - x2/2 + 1)^2 + (x2/2 - 1)^2)/(2*(x1/2 + x2/2 - 1)^2) - 1/(2*ta*(x1/2 + x2/2 - 101/100));
g2 = - (x1 - x2 + 2)/(x1/2 + x2/2 - 1) - 1/(2*ta*(x1/2 + x2/2 - 101/100)) - ((x1 - x2/2 + 1)^2 + (x2/2 - 1)^2)/(2*(x1/2 + x2/2 - 1)^2);

h11 = 2/(x1/2 + x2/2 - 1) + 1/(4*ta*(x1/2 + x2/2 - 101/100)^2) + ((x1 - x2/2 + 1)^2 + (x2/2 - 1)^2)/(2*(x1/2 + x2/2 - 1)^3) - (2*x1 - x2 + 2)/(x1/2 + x2/2 - 1)^2;

h12 = (x1 - x2 + 2)/(2*(x1/2 + x2/2 - 1)^2) - 1/(x1/2 + x2/2 - 1) + 1/(4*ta*(x1/2 + x2/2 - 101/100)^2) + ((x1 - x2/2 + 1)^2 + (x2/2 - 1)^2)/(2*(x1/2 + x2/2 - 1)^3) - (2*x1 - x2 + 2)/(2*(x1/2 + x2/2 - 1)^2);
 
h21 = (x1 - x2 + 2)/(2*(x1/2 + x2/2 - 1)^2) - 1/(x1/2 + x2/2 - 1) + 1/(4*ta*(x1/2 + x2/2 - 101/100)^2) + ((x1 - x2/2 + 1)^2 + (x2/2 - 1)^2)/(2*(x1/2 + x2/2 - 1)^3) - (2*x1 - x2 + 2)/(2*(x1/2 + x2/2 - 1)^2);
 
h22 = 1/(x1/2 + x2/2 - 1) + (x1 - x2 + 2)/(x1/2 + x2/2 - 1)^2 + 1/(4*ta*(x1/2 + x2/2 - 101/100)^2) + ((x1 - x2/2 + 1)^2 + (x2/2 - 1)^2)/(2*(x1/2 + x2/2 - 1)^3);
 

G = [g1; g2];
H = [h11 h12; h21 h22];
dk = -inv(H)*G;

%update alpha
if c'*dk <= 0 
    alpha = (de - c'*X - d)*(c'*dk)^(-1)*0.99;
else
    alpha = 1;
end

while 1/ta >= e 

    while norm(alpha*dk,2) >= e

        X = X + alpha*dk;
        x1 = X(1);
        x2 = X(2);

        g1 = (2*x1 - x2 + 2)/(x1/2 + x2/2 - 1) - ((x1 - x2/2 + 1)^2 + (x2/2 - 1)^2)/(2*(x1/2 + x2/2 - 1)^2) - 1/(2*ta*(x1/2 + x2/2 - 101/100));
        g2 = - (x1 - x2 + 2)/(x1/2 + x2/2 - 1) - 1/(2*ta*(x1/2 + x2/2 - 101/100)) - ((x1 - x2/2 + 1)^2 + (x2/2 - 1)^2)/(2*(x1/2 + x2/2 - 1)^2);

        h11 = 2/(x1/2 + x2/2 - 1) + 1/(4*ta*(x1/2 + x2/2 - 101/100)^2) + ((x1 - x2/2 + 1)^2 + (x2/2 - 1)^2)/(2*(x1/2 + x2/2 - 1)^3) - (2*x1 - x2 + 2)/(x1/2 + x2/2 - 1)^2;

        h12 = (x1 - x2 + 2)/(2*(x1/2 + x2/2 - 1)^2) - 1/(x1/2 + x2/2 - 1) + 1/(4*ta*(x1/2 + x2/2 - 101/100)^2) + ((x1 - x2/2 + 1)^2 + (x2/2 - 1)^2)/(2*(x1/2 + x2/2 - 1)^3) - (2*x1 - x2 + 2)/(2*(x1/2 + x2/2 - 1)^2);

        h21 = (x1 - x2 + 2)/(2*(x1/2 + x2/2 - 1)^2) - 1/(x1/2 + x2/2 - 1) + 1/(4*ta*(x1/2 + x2/2 - 101/100)^2) + ((x1 - x2/2 + 1)^2 + (x2/2 - 1)^2)/(2*(x1/2 + x2/2 - 1)^3) - (2*x1 - x2 + 2)/(2*(x1/2 + x2/2 - 1)^2);

        h22 = 1/(x1/2 + x2/2 - 1) + (x1 - x2 + 2)/(x1/2 + x2/2 - 1)^2 + 1/(4*ta*(x1/2 + x2/2 - 101/100)^2) + ((x1 - x2/2 + 1)^2 + (x2/2 - 1)^2)/(2*(x1/2 + x2/2 - 1)^3);

        G = [g1; g2];
        H = [h11 h12; h21 h22];
        dk = -inv(H)*G;

        if c'*dk <= 0 
            alpha = (de - c'*X - d)*(c'*dk)^(-1)*0.99;
        else
            alpha = 1;
        end

    end

X = X + alpha*dk;
x1 = X(1);
x2 = X(2);

g1 = (2*x1 - x2 + 2)/(x1/2 + x2/2 - 1) - ((x1 - x2/2 + 1)^2 + (x2/2 - 1)^2)/(2*(x1/2 + x2/2 - 1)^2) - 1/(2*ta*(x1/2 + x2/2 - 101/100));
g2 = - (x1 - x2 + 2)/(x1/2 + x2/2 - 1) - 1/(2*ta*(x1/2 + x2/2 - 101/100)) - ((x1 - x2/2 + 1)^2 + (x2/2 - 1)^2)/(2*(x1/2 + x2/2 - 1)^2);

h11 = 2/(x1/2 + x2/2 - 1) + 1/(4*ta*(x1/2 + x2/2 - 101/100)^2) + ((x1 - x2/2 + 1)^2 + (x2/2 - 1)^2)/(2*(x1/2 + x2/2 - 1)^3) - (2*x1 - x2 + 2)/(x1/2 + x2/2 - 1)^2;

h12 = (x1 - x2 + 2)/(2*(x1/2 + x2/2 - 1)^2) - 1/(x1/2 + x2/2 - 1) + 1/(4*ta*(x1/2 + x2/2 - 101/100)^2) + ((x1 - x2/2 + 1)^2 + (x2/2 - 1)^2)/(2*(x1/2 + x2/2 - 1)^3) - (2*x1 - x2 + 2)/(2*(x1/2 + x2/2 - 1)^2);
 
h21 = (x1 - x2 + 2)/(2*(x1/2 + x2/2 - 1)^2) - 1/(x1/2 + x2/2 - 1) + 1/(4*ta*(x1/2 + x2/2 - 101/100)^2) + ((x1 - x2/2 + 1)^2 + (x2/2 - 1)^2)/(2*(x1/2 + x2/2 - 1)^3) - (2*x1 - x2 + 2)/(2*(x1/2 + x2/2 - 1)^2);
 
h22 = 1/(x1/2 + x2/2 - 1) + (x1 - x2 + 2)/(x1/2 + x2/2 - 1)^2 + 1/(4*ta*(x1/2 + x2/2 - 101/100)^2) + ((x1 - x2/2 + 1)^2 + (x2/2 - 1)^2)/(2*(x1/2 + x2/2 - 1)^3);

G = [g1; g2];
H = [h11 h12; h21 h22];
dk = -inv(H)*G;

if c'*dk <= 0 
    alpha = (de - c'*X - d)*(c'*dk)^(-1)*0.99;
else
    alpha = 1;
end

ta = 10*ta;
end
disp('The solution point is');
disp(X);
